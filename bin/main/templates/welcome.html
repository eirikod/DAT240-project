<!DOCTYPE html> 
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="ISO-8859-1">
<title>proposer page</title>
<link th:href="@{/css/main.css}" rel="stylesheet">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
</head>
<body>
<div  class="container">
	<div class="row">
		Titre
	</div>
	
	<div class="row">
		<div class="col-sm">
			<form action="showImage" method="GET">
			    <select  id="dropOperator" name="selectedlabel">
			    <option value="0">Select a label </option>
			    <option th:each="label : ${listlabels}" th:value="${label}" th:text="${label}"></option>
			    </select>
			    <input type="submit">
			</form>
		</div>
			
		<div class="col-sm">
			Best player on this image
			<p th:text="${highestscore}">
			</p>
		</div>
	</div>
	
	<div class="row buttons-images-container">
		<div class="col-sm">
			<div style="position: relative;">
				<div th:each="image,iter : ${listimages}" class="alpha-mask">
					<img th:id="${iter.index}" th:attr="src=@{|${image}|}" onerror="this.style.display='none'"/>
				</div>			
			</div>
		</div>
		<div class="col-sm">
			<div class="row">
				<!-- temp0.style = "display: block; background-color: pink; opacity: 0.5" -->
				<div th:each="image,iter : ${listimages}" class="alpha-mask">
				 		<form action="showImage" method="POST">
				 			<input name="id" th:value="${iter.index}" type="hidden" />
				 			<input name="selectedlabel" th:value="${selectedlabel}" type="hidden" />
					 		<input class="myButton" th:value="${iter.index}" type="submit">
				 		</form>			 		
					<br>
				</div>
			</div>
			<div class="row">
				Timer & Score
			</div>
		</div>
	</div>

</div>
<!-- 	A voir / vérifier si spring gère pas lui même les event -->
	<script type="text/javascript">
		document.addEventListener("mouseover", ({ target }) => {
			console.log(target)
			if (target.className === "myButton") {	
				console.log(target)
				var element = document.getElementById(target.value).parentElement
// 				var element = document.getElementById(target.children[0].innerText).parentElement
				element.className = "beta-mask"
			}
		})
		document.addEventListener("mouseout", ({ target }) => {
			if (target.className === "myButton") {
// 				var element = document.getElementById(target.children[0].innerText).parentElement
				var element = document.getElementById(target.value).parentElement
				element.className = "alpha-mask"			
			}
		})
		setTimeout(() => {
			fetch(`http://localhost:8080/showImage?selectedlabel=${window.location.search}`).then(response => console.log(response))
		}, 10000)
// 		document.addEventListener("click", event => {
// 			if (event.target.className === "myButton") {
// 				var form = new FormData();
// 				form.append('id', event.target.children[0].innerText)
// 				fetch(`/game`, {
// 				  method: "POST",
// 				  body: form
// 				}).then(response => console.log(response))
// 			}
// 		})
	</script>

	

<!--  <div th:each="image,iter : ${listimages}" class="alpha-mask"> -->
<!--   <span id="myvar" th:text="${iter.index}"></span> -->
<!--   <div class="button"> -->
<!--   	<p> -->
<!--    		<a href="#"> -->
<!--    		<span id="myvar" th:text="${iter.index}"></span> -->
<!--    		</a> -->
<!--  	</p> -->
  	
<!--   </div> -->
<!-- </div> -->
 
</body>